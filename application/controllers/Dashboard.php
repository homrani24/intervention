<?php
/* 
 * Generated by CRUDigniter v3.2 
 * www.crudigniter.com
 */
 
class Dashboard extends CI_Controller{
    function __construct()
    {
        parent::__construct();
        // die(var_dump($this->session->userdata('logged_in') ["role"]));
        
    }

    function index()
    {
        $data['_view'] = 'dashboard';
        $this->load->view('layouts/main',$data);
    }
    
    function notif()
    {
        if($this->session->userdata('logged_in')['role'] == 1 ){

            $this->load->model('Reclamation_model');
            $data = $this->Reclamation_model->get_all_reclamation();
        }else{
            
            $this->load->model('Intervention_model');
            $data = $this->Intervention_model->get_client_intervention();
        }
        echo count($data);
    }
    function generate_pdf($id){
        $this->load->model('Contrat_model');
        $data = $this->Contrat_model->get_contrat_societer($id);
        $this->load->library('Pdf');
        $pdf = new Pdf('P', 'mm', 'A4', true, 'UTF-8', false);
        $pdf->SetTitle('My Title');
        $pdf->AddPage();
        $html='
        <h1>Contrat pdf</h1>
        <table style="width:100%" border="1">
        <tr>
          <th>type</th>
          <th>date de dÃ©but</th> 
          <th>date de fin</th>
          <th>societer</th>
        </tr>
        <tr>
        <td>'.$data['type'].'</td>
          <td>'.$data['date_deb'].'</td>
          <td>'.$data['date_fin'].'</td>
          <td>'.$data['name'].'</td>
        </tr>

      </table>
      ';
        $pdf->writeHTML($html);
        $pdf->Output('name.pdf', 'D');

    }

}
